# 🌟 情绪感知互动光影系统

一个创新的物联网交互项目，通过Arduino传感器收集环境数据，创造出一个能够感知和响应环境变化的虚拟宠物系统。

## 📋 项目特色

### 核心功能
1. **多传感器环境感知**
   - 温湿度监测（DHT22）
   - 光线强度检测（光敏传感器）
   - 运动检测（PIR传感器）
   - 加速度感应（3轴加速度传感器）
   - 旋钮控制输入

2. **智能情绪系统**
   - 基于环境参数的情绪计算
   - 动态情绪状态（开心、愉快、一般、沮丧、难过）
   - 情绪影响能量和快乐值

3. **实时交互反馈**
   - LED灯带颜色随情绪变化
   - 舵机动作响应
   - 网页端实时动画
   - WebSocket双向通信

4. **丰富的视觉效果**
   - 动态虚拟宠物动画
   - 粒子特效系统
   - 呼吸灯、流动、闪烁等LED效果
   - 响应式UI设计

## 🛠️ 硬件需求

### 必需组件
- Seeed XIAO开发板（ESP32C3/nRF52840 Sense/SAMD21）
- 1米防水LED灯带（WS2812B）
- 伺服舵机
- DHT22温湿度传感器
- PIR运动传感器
- 光敏传感器
- 旋钮传感器

### 可选组件
- 20键迷你遥控器 + 红外接收器
- 3轴加速度传感器
- 4色LED灯组件
- XIAO多功能拓展板

## 📦 软件安装

### 1. Python环境配置
```bash
# 安装Python依赖
pip install -r requirements.txt
```

### 2. Arduino设置
1. 安装Arduino IDE
2. 安装必要的库：
   - Adafruit NeoPixel
   - DHT sensor library
   - Servo
3. 根据你的开发板选择对应的板型
4. 上传`arduino_code.ino`到开发板

### 3. 硬件连接

#### 引脚定义
| 组件 | Arduino引脚 |
|------|------------|
| LED灯带 | D6 |
| 舵机 | D9 |
| DHT22 | D2 |
| PIR传感器 | D3 |
| 光敏传感器 | A0 |
| 旋钮 | A1 |
| 红外接收 | D7 |

## 🚀 运行项目

### 1. 启动Python服务器
```bash
python app.py
```
服务器将在 http://localhost:5000 启动

### 2. 访问网页界面
打开浏览器访问 http://localhost:5000

### 3. 开始互动
- 点击"喂食"增加能量
- 点击"玩耍"增加快乐值
- 点击"抚摸"安抚宠物
- 观察环境变化对宠物情绪的影响

## 🎨 系统工作原理

### 数据流程
1. **传感器采集** → Arduino读取各传感器数据
2. **串口通信** → 数据通过USB发送到Python
3. **数据处理** → Python计算情绪状态
4. **WebSocket推送** → 实时更新网页界面
5. **反馈控制** → 控制LED和舵机响应

### 情绪算法
```python
情绪值 = 温度舒适度 × 0.3 + 光线舒适度 × 0.3 + 
         快乐值 × 0.3 + 互动频率 × 0.1
```

### LED颜色映射
- 🟢 绿色：非常开心（情绪值 ≥ 80）
- 🔵 蓝色：开心（情绪值 ≥ 60）
- 🟡 黄色：一般（情绪值 ≥ 40）
- 🔴 红色：沮丧（情绪值 < 40）

## 🔧 自定义配置

### 修改传感器阈值
在`app.py`中调整：
```python
# 温度舒适区间
TEMP_COMFORT_MIN = 20
TEMP_COMFORT_MAX = 26

# 光线理想值
LIGHT_IDEAL = 60
```

### 添加新的交互动作
1. 在网页添加按钮
2. 在Python添加处理逻辑
3. 在Arduino添加舵机动作

### LED动画模式
通过串口发送命令切换：
- `ANIM:BREATH` - 呼吸灯
- `ANIM:FLOW` - 流动效果
- `ANIM:BLINK` - 闪烁效果

## 📊 数据监控

系统提供实时数据监控：
- 环境温度/湿度
- 光线强度
- 运动检测状态
- 情绪/能量/快乐值变化曲线

## 🎮 扩展玩法

### 1. 音乐互动
结合声音传感器，让宠物随音乐节奏变化

### 2. 天气联动
接入天气API，室外天气影响宠物心情

### 3. 多人互动
添加用户系统，多人共同照顾虚拟宠物

### 4. AI对话
集成语音识别，与宠物进行语音互动

### 5. 手机控制
开发手机APP，远程照看宠物

## 🐛 故障排除

### Arduino连接失败
1. 检查USB连接
2. 确认串口号正确
3. 检查波特率设置（9600）

### 传感器无数据
1. 检查接线是否正确
2. 验证传感器供电（3.3V或5V）
3. 测试单个传感器功能

### 网页无法访问
1. 确认Python服务器运行中
2. 检查防火墙设置
3. 尝试使用127.0.0.1替代localhost

## 📝 项目结构
```
emotion-sensing-system/
├── app.py                 # Python后端服务器
├── arduino_code.ino       # Arduino固件
├── templates/
│   └── index.html        # 网页界面
├── requirements.txt       # Python依赖
└── README.md             # 项目说明
```

## 🌈 未来计划

- [ ] 添加数据存储和历史记录
- [ ] 实现机器学习预测情绪
- [ ] 支持多个虚拟宠物
- [ ] 添加社交分享功能
- [ ] 开发移动端应用

## 📄 开源协议

MIT License

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

## 💡 创意来源

本项目旨在探索物联网与情感计算的结合，通过硬件传感器和软件算法，创造一个能够感知环境、表达情绪的智能系统，为用户带来全新的交互体验。

---

🎉 享受与你的虚拟伙伴互动的乐趣吧！
